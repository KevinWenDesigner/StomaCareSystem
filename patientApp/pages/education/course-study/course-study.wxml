<!--patient-app/pages/education/course-study/course-study.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-left" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <text class="page-title">{{course.title}}</text>
    <view class="header-right"></view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-state">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- è¯¾ç¨‹å­¦ä¹ å†…å®¹ -->
  <view wx:else class="study-content">
    <!-- å­¦ä¹ è¿›åº¦ -->
    <view class="progress-section">
      <view class="progress-header">
        <text class="progress-title">å­¦ä¹ è¿›åº¦</text>
        <text class="progress-percent">{{studyProgress}}%</text>
      </view>
      
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{studyProgress}}%"></view>
      </view>
      
      <text class="progress-text">å·²å®Œæˆ {{studyProgress}}%</text>
    </view>

    <!-- å½“å‰ç« èŠ‚ -->
    <view wx:if="{{course.chapters && course.chapters[currentChapter]}}" class="chapter-section">
      <view class="chapter-header">
        <text class="chapter-title">ç¬¬{{currentChapter + 1}}ç« ï¼š{{course.chapters[currentChapter].title}}</text>
        <text class="chapter-duration">{{course.chapters[currentChapter].duration}}</text>
      </view>
      
      <view class="chapter-content">
        <view class="content-card">
          <text class="content-title">ç« èŠ‚å†…å®¹</text>
          <text class="content-text">
            è¿™é‡Œæ˜¯ç¬¬{{currentChapter + 1}}ç« çš„å­¦ä¹ å†…å®¹ã€‚é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæ‚¨å°†æŒæ¡ç›¸å…³çš„æŠ¤ç†çŸ¥è¯†å’ŒæŠ€èƒ½ã€‚
            è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹å†…å®¹ï¼Œå®Œæˆåç‚¹å‡»"å®Œæˆå­¦ä¹ "æŒ‰é’®ã€‚
          </text>
          
          <!-- æ¨¡æ‹Ÿå­¦ä¹ å†…å®¹ -->
          <view class="learning-points">
            <view class="point-item">
              <text class="point-icon">ğŸ“</text>
              <text class="point-text">å­¦ä¹ è¦ç‚¹1ï¼šäº†è§£åŸºæœ¬æ¦‚å¿µ</text>
            </view>
            <view class="point-item">
              <text class="point-icon">ğŸ¯</text>
              <text class="point-text">å­¦ä¹ è¦ç‚¹2ï¼šæŒæ¡æ“ä½œæŠ€å·§</text>
            </view>
            <view class="point-item">
              <text class="point-icon">âš ï¸</text>
              <text class="point-text">å­¦ä¹ è¦ç‚¹3ï¼šæ³¨æ„äº‹é¡¹</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç« èŠ‚åˆ—è¡¨ -->
    <view wx:if="{{course.chapters}}" class="chapters-section">
      <view class="section-header">
        <text class="section-title">è¯¾ç¨‹ç« èŠ‚</text>
        <text class="section-subtitle">å…±{{course.chapters.length}}ä¸ªç« èŠ‚</text>
      </view>
      
      <view class="chapters-list">
        <view wx:for="{{course.chapters}}" wx:key="id" 
              class="chapter-item {{index === currentChapter ? 'active' : ''}} {{item.completed ? 'completed' : ''}}"
              bindtap="startChapter" data-index="{{index}}">
          <view class="chapter-info">
            <view class="chapter-header">
              <text class="chapter-number">ç¬¬{{item.id}}ç« </text>
              <text class="chapter-duration">{{item.duration}}</text>
            </view>
            <text class="chapter-title">{{item.title}}</text>
          </view>
          
          <view class="chapter-status">
            <text wx:if="{{item.completed}}" class="status-completed">å·²å®Œæˆ</text>
            <text wx:elif="{{index === currentChapter}}" class="status-current">å­¦ä¹ ä¸­</text>
            <text wx:else class="status-pending">å¾…å­¦ä¹ </text>
          </view>
        </view>
      </view>
    </view>

    <!-- è¯¾ç¨‹å®Œæˆæç¤º -->
    <view wx:if="{{isCompleted}}" class="completion-section">
      <view class="completion-card">
        <text class="completion-icon">ğŸ‰</text>
        <text class="completion-title">æ­å–œï¼</text>
        <text class="completion-text">æ‚¨å·²å®Œæˆæœ¬è¯¾ç¨‹çš„å­¦ä¹ </text>
        <text class="completion-desc">ç»§ç»­å­¦ä¹ å…¶ä»–è¯¾ç¨‹ï¼Œæå‡æŠ¤ç†æŠ€èƒ½</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="bottom-actions">
    <button wx:if="{{!isCompleted && course.chapters && course.chapters[currentChapter]}}" 
            class="action-btn primary" bindtap="completeChapter">
      <text class="btn-text">å®Œæˆå­¦ä¹ </text>
    </button>
    <button wx:else class="action-btn secondary" bindtap="goBack">
      <text class="btn-text">è¿”å›è¯¾ç¨‹</text>
    </button>
  </view>
</view> 