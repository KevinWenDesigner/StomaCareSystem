<!--patient-app/pages/index/index.wxml-->
<view class="container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view wx:if="{{!isLoggedIn}}" class="welcome-section">
    <view class="welcome-content">
      <view class="welcome-icon">ğŸ¥</view>
      <text class="welcome-title">é€ å£æŠ¤ç†æ‚£è€…ç«¯</text>
      <text class="welcome-subtitle">ä¸“ä¸šçš„é€ å£æŠ¤ç†ç®¡ç†å¹³å°</text>
      <text class="welcome-desc">ä¸ºæ‚¨æä¾›å…¨æ–¹ä½çš„é€ å£æŠ¤ç†æœåŠ¡</text>
      
      <button class="start-btn" bindtap="simulateLogin">
        <text class="btn-text">å¼€å§‹ä½¿ç”¨</text>
      </button>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else>
    <!-- é¡µé¢æ ‡é¢˜ -->
    <view class="page-header">
      <view class="user-info-header">
        <view class="user-avatar">
          <!-- å¦‚æœæœ‰å¾®ä¿¡å¤´åƒåˆ™æ˜¾ç¤ºï¼Œå¦åˆ™æ˜¾ç¤ºæ–‡å­—å¤´åƒ -->
          <image wx:if="{{patientInfo.avatarUrl}}" class="avatar-image" src="{{patientInfo.avatarUrl}}" mode="aspectFill"></image>
          <text wx:else class="avatar-text">{{patientInfo.displayName.charAt(0)}}</text>
        </view>
        <view class="user-welcome">
          <text class="page-subtitle">æ¬¢è¿å›æ¥ï¼Œ{{patientInfo.displayName}}</text>
          <text class="user-care-info">{{patientInfo.age}}å² Â· {{patientInfo.gender}} Â· æŠ¤ç†{{patientInfo.careDays}}å¤©</text>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <view class="quick-actions">
      <view class="action-card" bindtap="goToCamera">
        <view class="action-icon">ğŸ“·</view>
        <text class="action-title">AIè¯„ä¼°</text>
        <text class="action-desc">æ‹ç…§è·å¾—ä¸“ä¸šå»ºè®®</text>
      </view>
      
      <view class="action-card" bindtap="goToDiary">
        <view class="action-icon">ğŸ“</view>
        <text class="action-title">ç—‡çŠ¶æ—¥è®°</text>
        <text class="action-desc">è®°å½•æ¯æ—¥ç—‡çŠ¶</text>
      </view>
      
      <view class="action-card" bindtap="goToEducation">
        <view class="action-icon">ğŸ“š</view>
        <text class="action-title">æŠ¤ç†æ•™è‚²</text>
        <text class="action-desc">å­¦ä¹ æŠ¤ç†çŸ¥è¯†</text>
      </view>
      
      <view class="action-card" bindtap="goToProfile">
        <view class="action-icon">ğŸ‘¤</view>
        <text class="action-title">ä¸ªäººä¸­å¿ƒ</text>
        <text class="action-desc">ç®¡ç†ä¸ªäººä¿¡æ¯</text>
      </view>
    </view>

    <!-- ä»Šæ—¥çŠ¶æ€ -->
    <view class="status-section">
      <view class="section-header">
        <view>
          <text class="section-title">ä»Šæ—¥çŠ¶æ€</text>
          <text class="section-subtitle">{{todayDate}}</text>
        </view>
      </view>
      
      <view class="status-grid">
        <view class="status-card">
          <view class="status-icon">ğŸ“Š</view>
          <text class="status-number">{{todayStats.assessments}}</text>
          <text class="status-label">ä»Šæ—¥è¯„ä¼°</text>
        </view>
        
        <view class="status-card">
          <view class="status-icon">ğŸ“</view>
          <text class="status-number">{{todayStats.records}}</text>
          <text class="status-label">ç—‡çŠ¶è®°å½•</text>
        </view>
        
        <view class="status-card">
          <view class="status-icon">ğŸ“š</view>
          <text class="status-number">{{todayStats.lessons}}</text>
          <text class="status-label">å­¦ä¹ è¯¾ç¨‹</text>
        </view>
        
        <view class="status-card">
          <view class="status-icon">ğŸ¯</view>
          <text class="status-number">{{todayStats.score}}</text>
          <text class="status-label">å¥åº·è¯„åˆ†</text>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘è®°å½• -->
    <view class="records-section">
      <view class="section-header">
        <text class="section-title">æœ€è¿‘è®°å½•</text>
        <button class="view-all-btn" bindtap="goToDiary">
          <text class="btn-text">æŸ¥çœ‹å…¨éƒ¨</text>
        </button>
      </view>
      
      <view wx:if="{{recentRecords.length === 0}}" class="empty-state">
        <text class="empty-icon">ğŸ“</text>
        <text class="empty-text">æš‚æ— è®°å½•</text>
        <text class="empty-subtext">å¼€å§‹è®°å½•æ‚¨çš„ç—‡çŠ¶å˜åŒ–</text>
      </view>
      
      <view wx:else class="records-list">
        <view wx:for="{{recentRecords}}" wx:key="id" class="record-item">
          <view class="record-header">
            <text class="record-title">{{item.title}}</text>
            <text class="record-time">{{item.time}}</text>
          </view>
          
          <text class="record-desc">{{item.description}}</text>
        </view>
      </view>
    </view>

    <!-- æŠ¤ç†æé†’ -->
    <view class="reminders-section">
      <view class="section-header">
        <view>
          <text class="section-title">æŠ¤ç†æé†’</text>
          <text class="section-subtitle">ä»Šæ—¥å¾…åŠäº‹é¡¹</text>
        </view>
      </view>
      
      <view wx:if="{{reminders.length === 0}}" class="empty-state">
        <text class="empty-icon">âœ…</text>
        <text class="empty-text">ä»Šæ—¥æ— æé†’</text>
        <text class="empty-subtext">ç»§ç»­ä¿æŒè‰¯å¥½çš„æŠ¤ç†ä¹ æƒ¯</text>
      </view>
      
      <view wx:else class="reminder-list">
        <view wx:for="{{reminders}}" wx:key="id" class="reminder-item">
          <view class="reminder-icon">â°</view>
          <view class="reminder-content">
            <text class="reminder-title">{{item.title}}</text>
            <text class="reminder-time">{{item.time}}</text>
          </view>
          
          <button wx:if="{{!item.completed}}" 
                  class="complete-btn" 
                  bindtap="completeReminder" 
                  data-id="{{item.id}}">
            <text class="btn-text">å®Œæˆ</text>
          </button>
          
          <view wx:else class="completed-icon">âœ…</view>
        </view>
      </view>
    </view>
  </view>
</view> 